(function(rt){typeof define=="function"&&define.amd?define(rt):rt()})(function(){"use strict";const rt=Symbol("Comlink.proxy"),Ct=Symbol("Comlink.endpoint"),Gt=Symbol("Comlink.releaseProxy"),ut=Symbol("Comlink.thrown"),mt=t=>typeof t=="object"&&t!==null||typeof t=="function",Ot={canHandle:t=>mt(t)&&t[rt],serialize(t){const{port1:r,port2:i}=new MessageChannel;return ft(t,r),[i,[i]]},deserialize(t){return t.start(),Dt(t)}},Jt={canHandle:t=>mt(t)&&ut in t,serialize({value:t}){let r;return t instanceof Error?r={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:r={isError:!1,value:t},[r,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},Et=new Map([["proxy",Ot],["throw",Jt]]);function ft(t,r=self){r.addEventListener("message",function i(h){if(!h||!h.data)return;const{id:f,type:c,path:l}=Object.assign({path:[]},h.data),u=(h.data.argumentList||[]).map(Y);let d;try{const k=l.slice(0,-1).reduce((B,N)=>B[N],t),m=l.reduce((B,N)=>B[N],t);switch(c){case"GET":d=m;break;case"SET":k[l.slice(-1)[0]]=Y(h.data.value),d=!0;break;case"APPLY":d=m.apply(k,u);break;case"CONSTRUCT":{const B=new m(...u);d=$t(B)}break;case"ENDPOINT":{const{port1:B,port2:N}=new MessageChannel;ft(t,N),d=vt(B,[B])}break;case"RELEASE":d=void 0;break;default:return}}catch(k){d={value:k,[ut]:0}}Promise.resolve(d).catch(k=>({value:k,[ut]:0})).then(k=>{const[m,B]=ct(k);r.postMessage(Object.assign(Object.assign({},m),{id:f}),B),c==="RELEASE"&&(r.removeEventListener("message",i),kt(r))})}),r.start&&r.start()}function zt(t){return t.constructor.name==="MessagePort"}function kt(t){zt(t)&&t.close()}function Dt(t,r){return pt(t,[],r)}function st(t){if(t)throw new Error("Proxy has been released and is not useable")}function pt(t,r=[],i=function(){}){let h=!1;const f=new Proxy(i,{get(c,l){if(st(h),l===Gt)return()=>K(t,{type:"RELEASE",path:r.map(u=>u.toString())}).then(()=>{kt(t),h=!0});if(l==="then"){if(r.length===0)return{then:()=>f};const u=K(t,{type:"GET",path:r.map(d=>d.toString())}).then(Y);return u.then.bind(u)}return pt(t,[...r,l])},set(c,l,u){st(h);const[d,k]=ct(u);return K(t,{type:"SET",path:[...r,l].map(m=>m.toString()),value:d},k).then(Y)},apply(c,l,u){st(h);const d=r[r.length-1];if(d===Ct)return K(t,{type:"ENDPOINT"}).then(Y);if(d==="bind")return pt(t,r.slice(0,-1));const[k,m]=It(u);return K(t,{type:"APPLY",path:r.map(B=>B.toString()),argumentList:k},m).then(Y)},construct(c,l){st(h);const[u,d]=It(l);return K(t,{type:"CONSTRUCT",path:r.map(k=>k.toString()),argumentList:u},d).then(Y)}});return f}function Vt(t){return Array.prototype.concat.apply([],t)}function It(t){const r=t.map(ct);return[r.map(i=>i[0]),Vt(r.map(i=>i[1]))]}const bt=new WeakMap;function vt(t,r){return bt.set(t,r),t}function $t(t){return Object.assign(t,{[rt]:!0})}function ct(t){for(const[r,i]of Et)if(i.canHandle(t)){const[h,f]=i.serialize(t);return[{type:"HANDLER",name:r,value:h},f]}return[{type:"RAW",value:t},bt.get(t)||[]]}function Y(t){switch(t.type){case"HANDLER":return Et.get(t.name).deserialize(t.value);case"RAW":return t.value}}function K(t,r,i){return new Promise(h=>{const f=Ht();t.addEventListener("message",function c(l){!l.data||!l.data.id||l.data.id!==f||(t.removeEventListener("message",c),h(l.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:f},r),i)})}function Ht(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var I={},ht={};ht.byteLength=Xt,ht.toByteArray=Qt,ht.fromByteArray=rr;for(var V=[],D=[],Yt=typeof Uint8Array<"u"?Uint8Array:Array,lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q=0,qt=lt.length;Q<qt;++Q)V[Q]=lt[Q],D[lt.charCodeAt(Q)]=Q;D["-".charCodeAt(0)]=62,D["_".charCodeAt(0)]=63;function Bt(t){var r=t.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");i===-1&&(i=r);var h=i===r?0:4-i%4;return[i,h]}function Xt(t){var r=Bt(t),i=r[0],h=r[1];return(i+h)*3/4-h}function Kt(t,r,i){return(r+i)*3/4-i}function Qt(t){var r,i=Bt(t),h=i[0],f=i[1],c=new Yt(Kt(t,h,f)),l=0,u=f>0?h-4:h,d;for(d=0;d<u;d+=4)r=D[t.charCodeAt(d)]<<18|D[t.charCodeAt(d+1)]<<12|D[t.charCodeAt(d+2)]<<6|D[t.charCodeAt(d+3)],c[l++]=r>>16&255,c[l++]=r>>8&255,c[l++]=r&255;return f===2&&(r=D[t.charCodeAt(d)]<<2|D[t.charCodeAt(d+1)]>>4,c[l++]=r&255),f===1&&(r=D[t.charCodeAt(d)]<<10|D[t.charCodeAt(d+1)]<<4|D[t.charCodeAt(d+2)]>>2,c[l++]=r>>8&255,c[l++]=r&255),c}function jt(t){return V[t>>18&63]+V[t>>12&63]+V[t>>6&63]+V[t&63]}function tr(t,r,i){for(var h,f=[],c=r;c<i;c+=3)h=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(t[c+2]&255),f.push(jt(h));return f.join("")}function rr(t){for(var r,i=t.length,h=i%3,f=[],c=16383,l=0,u=i-h;l<u;l+=c)f.push(tr(t,l,l+c>u?u:l+c));return h===1?(r=t[i-1],f.push(V[r>>2]+V[r<<4&63]+"==")):h===2&&(r=(t[i-2]<<8)+t[i-1],f.push(V[r>>10]+V[r>>4&63]+V[r<<2&63]+"=")),f.join("")}var gt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */gt.read=function(t,r,i,h,f){var c,l,u=f*8-h-1,d=(1<<u)-1,k=d>>1,m=-7,B=i?f-1:0,N=i?-1:1,O=t[r+B];for(B+=N,c=O&(1<<-m)-1,O>>=-m,m+=u;m>0;c=c*256+t[r+B],B+=N,m-=8);for(l=c&(1<<-m)-1,c>>=-m,m+=h;m>0;l=l*256+t[r+B],B+=N,m-=8);if(c===0)c=1-k;else{if(c===d)return l?NaN:(O?-1:1)*(1/0);l=l+Math.pow(2,h),c=c-k}return(O?-1:1)*l*Math.pow(2,c-h)},gt.write=function(t,r,i,h,f,c){var l,u,d,k=c*8-f-1,m=(1<<k)-1,B=m>>1,N=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=h?0:c-1,nt=h?1:-1,it=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(u=isNaN(r)?1:0,l=m):(l=Math.floor(Math.log(r)/Math.LN2),r*(d=Math.pow(2,-l))<1&&(l--,d*=2),l+B>=1?r+=N/d:r+=N*Math.pow(2,1-B),r*d>=2&&(l++,d/=2),l+B>=m?(u=0,l=m):l+B>=1?(u=(r*d-1)*Math.pow(2,f),l=l+B):(u=r*Math.pow(2,B-1)*Math.pow(2,f),l=0));f>=8;t[i+O]=u&255,O+=nt,u/=256,f-=8);for(l=l<<f|u,k+=f;k>0;t[i+O]=l&255,O+=nt,l/=256,k-=8);t[i+O-nt]|=it*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const r=ht,i=gt,h=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=hr,t.INSPECT_MAX_BYTES=50;const f=2147483647;t.kMaxLength=f,u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const o=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(o,e),o.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(o){if(o>f)throw new RangeError('The value "'+o+'" is invalid for option "size"');const e=new Uint8Array(o);return Object.setPrototypeOf(e,u.prototype),e}function u(o,e,n){if(typeof o=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(o)}return d(o,e,n)}u.poolSize=8192;function d(o,e,n){if(typeof o=="string")return N(o,e);if(ArrayBuffer.isView(o))return nt(o);if(o==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(v(o,ArrayBuffer)||o&&v(o.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(v(o,SharedArrayBuffer)||o&&v(o.buffer,SharedArrayBuffer)))return it(o,e,n);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const s=o.valueOf&&o.valueOf();if(s!=null&&s!==o)return u.from(s,e,n);const a=sr(o);if(a)return a;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return u.from(o[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}u.from=function(o,e,n){return d(o,e,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function k(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function m(o,e,n){return k(o),o<=0?l(o):e!==void 0?typeof n=="string"?l(o).fill(e,n):l(o).fill(e):l(o)}u.alloc=function(o,e,n){return m(o,e,n)};function B(o){return k(o),l(o<0?0:wt(o)|0)}u.allocUnsafe=function(o){return B(o)},u.allocUnsafeSlow=function(o){return B(o)};function N(o,e){if((typeof e!="string"||e==="")&&(e="utf8"),!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=Mt(o,e)|0;let s=l(n);const a=s.write(o,e);return a!==n&&(s=s.slice(0,a)),s}function O(o){const e=o.length<0?0:wt(o.length)|0,n=l(e);for(let s=0;s<e;s+=1)n[s]=o[s]&255;return n}function nt(o){if(v(o,Uint8Array)){const e=new Uint8Array(o);return it(e.buffer,e.byteOffset,e.byteLength)}return O(o)}function it(o,e,n){if(e<0||o.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let s;return e===void 0&&n===void 0?s=new Uint8Array(o):n===void 0?s=new Uint8Array(o,e):s=new Uint8Array(o,e,n),Object.setPrototypeOf(s,u.prototype),s}function sr(o){if(u.isBuffer(o)){const e=wt(o.length)|0,n=l(e);return n.length===0||o.copy(n,0,0,e),n}if(o.length!==void 0)return typeof o.length!="number"||xt(o.length)?l(0):O(o);if(o.type==="Buffer"&&Array.isArray(o.data))return O(o.data)}function wt(o){if(o>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return o|0}function hr(o){return+o!=o&&(o=0),u.alloc(+o)}u.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==u.prototype},u.compare=function(e,n){if(v(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),v(n,Uint8Array)&&(n=u.from(n,n.offset,n.byteLength)),!u.isBuffer(e)||!u.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===n)return 0;let s=e.length,a=n.length;for(let p=0,g=Math.min(s,a);p<g;++p)if(e[p]!==n[p]){s=e[p],a=n[p];break}return s<a?-1:a<s?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,n){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return u.alloc(0);let s;if(n===void 0)for(n=0,s=0;s<e.length;++s)n+=e[s].length;const a=u.allocUnsafe(n);let p=0;for(s=0;s<e.length;++s){let g=e[s];if(v(g,Uint8Array))p+g.length>a.length?(u.isBuffer(g)||(g=u.from(g)),g.copy(a,p)):Uint8Array.prototype.set.call(a,g,p);else if(u.isBuffer(g))g.copy(a,p);else throw new TypeError('"list" argument must be an Array of Buffers');p+=g.length}return a};function Mt(o,e){if(u.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||v(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);const n=o.length,s=arguments.length>2&&arguments[2]===!0;if(!s&&n===0)return 0;let a=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return dt(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return At(o).length;default:if(a)return s?-1:dt(o).length;e=(""+e).toLowerCase(),a=!0}}u.byteLength=Mt;function ar(o,e,n){let s=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,e>>>=0,n<=e))return"";for(o||(o="utf8");;)switch(o){case"hex":return xr(this,e,n);case"utf8":case"utf-8":return Tt(this,e,n);case"ascii":return yr(this,e,n);case"latin1":case"binary":return dr(this,e,n);case"base64":return gr(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return mr(this,e,n);default:if(s)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),s=!0}}u.prototype._isBuffer=!0;function X(o,e,n){const s=o[e];o[e]=o[n],o[n]=s}u.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)X(this,n,n+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4)X(this,n,n+3),X(this,n+1,n+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8)X(this,n,n+7),X(this,n+1,n+6),X(this,n+2,n+5),X(this,n+3,n+4);return this},u.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?Tt(this,0,e):ar.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:u.compare(this,e)===0},u.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},h&&(u.prototype[h]=u.prototype.inspect),u.prototype.compare=function(e,n,s,a,p){if(v(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(n===void 0&&(n=0),s===void 0&&(s=e?e.length:0),a===void 0&&(a=0),p===void 0&&(p=this.length),n<0||s>e.length||a<0||p>this.length)throw new RangeError("out of range index");if(a>=p&&n>=s)return 0;if(a>=p)return-1;if(n>=s)return 1;if(n>>>=0,s>>>=0,a>>>=0,p>>>=0,this===e)return 0;let g=p-a,E=s-n;const Z=Math.min(g,E),R=this.slice(a,p),L=e.slice(n,s);for(let _=0;_<Z;++_)if(R[_]!==L[_]){g=R[_],E=L[_];break}return g<E?-1:E<g?1:0};function St(o,e,n,s,a){if(o.length===0)return-1;if(typeof n=="string"?(s=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,xt(n)&&(n=a?0:o.length-1),n<0&&(n=o.length+n),n>=o.length){if(a)return-1;n=o.length-1}else if(n<0)if(a)n=0;else return-1;if(typeof e=="string"&&(e=u.from(e,s)),u.isBuffer(e))return e.length===0?-1:_t(o,e,n,s,a);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?a?Uint8Array.prototype.indexOf.call(o,e,n):Uint8Array.prototype.lastIndexOf.call(o,e,n):_t(o,[e],n,s,a);throw new TypeError("val must be string, number or Buffer")}function _t(o,e,n,s,a){let p=1,g=o.length,E=e.length;if(s!==void 0&&(s=String(s).toLowerCase(),s==="ucs2"||s==="ucs-2"||s==="utf16le"||s==="utf-16le")){if(o.length<2||e.length<2)return-1;p=2,g/=2,E/=2,n/=2}function Z(L,_){return p===1?L[_]:L.readUInt16BE(_*p)}let R;if(a){let L=-1;for(R=n;R<g;R++)if(Z(o,R)===Z(e,L===-1?0:R-L)){if(L===-1&&(L=R),R-L+1===E)return L*p}else L!==-1&&(R-=R-L),L=-1}else for(n+E>g&&(n=g-E),R=n;R>=0;R--){let L=!0;for(let _=0;_<E;_++)if(Z(o,R+_)!==Z(e,_)){L=!1;break}if(L)return R}return-1}u.prototype.includes=function(e,n,s){return this.indexOf(e,n,s)!==-1},u.prototype.indexOf=function(e,n,s){return St(this,e,n,s,!0)},u.prototype.lastIndexOf=function(e,n,s){return St(this,e,n,s,!1)};function ur(o,e,n,s){n=Number(n)||0;const a=o.length-n;s?(s=Number(s),s>a&&(s=a)):s=a;const p=e.length;s>p/2&&(s=p/2);let g;for(g=0;g<s;++g){const E=parseInt(e.substr(g*2,2),16);if(xt(E))return g;o[n+g]=E}return g}function fr(o,e,n,s){return at(dt(e,o.length-n),o,n,s)}function pr(o,e,n,s){return at(br(e),o,n,s)}function cr(o,e,n,s){return at(At(e),o,n,s)}function lr(o,e,n,s){return at(Br(e,o.length-n),o,n,s)}u.prototype.write=function(e,n,s,a){if(n===void 0)a="utf8",s=this.length,n=0;else if(s===void 0&&typeof n=="string")a=n,s=this.length,n=0;else if(isFinite(n))n=n>>>0,isFinite(s)?(s=s>>>0,a===void 0&&(a="utf8")):(a=s,s=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const p=this.length-n;if((s===void 0||s>p)&&(s=p),e.length>0&&(s<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let g=!1;for(;;)switch(a){case"hex":return ur(this,e,n,s);case"utf8":case"utf-8":return fr(this,e,n,s);case"ascii":case"latin1":case"binary":return pr(this,e,n,s);case"base64":return cr(this,e,n,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lr(this,e,n,s);default:if(g)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),g=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function gr(o,e,n){return e===0&&n===o.length?r.fromByteArray(o):r.fromByteArray(o.slice(e,n))}function Tt(o,e,n){n=Math.min(o.length,n);const s=[];let a=e;for(;a<n;){const p=o[a];let g=null,E=p>239?4:p>223?3:p>191?2:1;if(a+E<=n){let Z,R,L,_;switch(E){case 1:p<128&&(g=p);break;case 2:Z=o[a+1],(Z&192)===128&&(_=(p&31)<<6|Z&63,_>127&&(g=_));break;case 3:Z=o[a+1],R=o[a+2],(Z&192)===128&&(R&192)===128&&(_=(p&15)<<12|(Z&63)<<6|R&63,_>2047&&(_<55296||_>57343)&&(g=_));break;case 4:Z=o[a+1],R=o[a+2],L=o[a+3],(Z&192)===128&&(R&192)===128&&(L&192)===128&&(_=(p&15)<<18|(Z&63)<<12|(R&63)<<6|L&63,_>65535&&_<1114112&&(g=_))}}g===null?(g=65533,E=1):g>65535&&(g-=65536,s.push(g>>>10&1023|55296),g=56320|g&1023),s.push(g),a+=E}return wr(s)}const Ft=4096;function wr(o){const e=o.length;if(e<=Ft)return String.fromCharCode.apply(String,o);let n="",s=0;for(;s<e;)n+=String.fromCharCode.apply(String,o.slice(s,s+=Ft));return n}function yr(o,e,n){let s="";n=Math.min(o.length,n);for(let a=e;a<n;++a)s+=String.fromCharCode(o[a]&127);return s}function dr(o,e,n){let s="";n=Math.min(o.length,n);for(let a=e;a<n;++a)s+=String.fromCharCode(o[a]);return s}function xr(o,e,n){const s=o.length;(!e||e<0)&&(e=0),(!n||n<0||n>s)&&(n=s);let a="";for(let p=e;p<n;++p)a+=Mr[o[p]];return a}function mr(o,e,n){const s=o.slice(e,n);let a="";for(let p=0;p<s.length-1;p+=2)a+=String.fromCharCode(s[p]+s[p+1]*256);return a}u.prototype.slice=function(e,n){const s=this.length;e=~~e,n=n===void 0?s:~~n,e<0?(e+=s,e<0&&(e=0)):e>s&&(e=s),n<0?(n+=s,n<0&&(n=0)):n>s&&(n=s),n<e&&(n=e);const a=this.subarray(e,n);return Object.setPrototypeOf(a,u.prototype),a};function W(o,e,n){if(o%1!==0||o<0)throw new RangeError("offset is not uint");if(o+e>n)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(e,n,s){e=e>>>0,n=n>>>0,s||W(e,n,this.length);let a=this[e],p=1,g=0;for(;++g<n&&(p*=256);)a+=this[e+g]*p;return a},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,n,s){e=e>>>0,n=n>>>0,s||W(e,n,this.length);let a=this[e+--n],p=1;for(;n>0&&(p*=256);)a+=this[e+--n]*p;return a},u.prototype.readUint8=u.prototype.readUInt8=function(e,n){return e=e>>>0,n||W(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,n){return e=e>>>0,n||W(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,n){return e=e>>>0,n||W(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,n){return e=e>>>0,n||W(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,n){return e=e>>>0,n||W(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=H(function(e){e=e>>>0,tt(e,"offset");const n=this[e],s=this[e+7];(n===void 0||s===void 0)&&ot(e,this.length-8);const a=n+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,p=this[++e]+this[++e]*2**8+this[++e]*2**16+s*2**24;return BigInt(a)+(BigInt(p)<<BigInt(32))}),u.prototype.readBigUInt64BE=H(function(e){e=e>>>0,tt(e,"offset");const n=this[e],s=this[e+7];(n===void 0||s===void 0)&&ot(e,this.length-8);const a=n*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],p=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+s;return(BigInt(a)<<BigInt(32))+BigInt(p)}),u.prototype.readIntLE=function(e,n,s){e=e>>>0,n=n>>>0,s||W(e,n,this.length);let a=this[e],p=1,g=0;for(;++g<n&&(p*=256);)a+=this[e+g]*p;return p*=128,a>=p&&(a-=Math.pow(2,8*n)),a},u.prototype.readIntBE=function(e,n,s){e=e>>>0,n=n>>>0,s||W(e,n,this.length);let a=n,p=1,g=this[e+--a];for(;a>0&&(p*=256);)g+=this[e+--a]*p;return p*=128,g>=p&&(g-=Math.pow(2,8*n)),g},u.prototype.readInt8=function(e,n){return e=e>>>0,n||W(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},u.prototype.readInt16LE=function(e,n){e=e>>>0,n||W(e,2,this.length);const s=this[e]|this[e+1]<<8;return s&32768?s|4294901760:s},u.prototype.readInt16BE=function(e,n){e=e>>>0,n||W(e,2,this.length);const s=this[e+1]|this[e]<<8;return s&32768?s|4294901760:s},u.prototype.readInt32LE=function(e,n){return e=e>>>0,n||W(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,n){return e=e>>>0,n||W(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=H(function(e){e=e>>>0,tt(e,"offset");const n=this[e],s=this[e+7];(n===void 0||s===void 0)&&ot(e,this.length-8);const a=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(s<<24);return(BigInt(a)<<BigInt(32))+BigInt(n+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),u.prototype.readBigInt64BE=H(function(e){e=e>>>0,tt(e,"offset");const n=this[e],s=this[e+7];(n===void 0||s===void 0)&&ot(e,this.length-8);const a=(n<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(a)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+s)}),u.prototype.readFloatLE=function(e,n){return e=e>>>0,n||W(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,n){return e=e>>>0,n||W(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,n){return e=e>>>0,n||W(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,n){return e=e>>>0,n||W(e,8,this.length),i.read(this,e,!1,52,8)};function J(o,e,n,s,a,p){if(!u.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<p)throw new RangeError('"value" argument is out of bounds');if(n+s>o.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,n,s,a){if(e=+e,n=n>>>0,s=s>>>0,!a){const E=Math.pow(2,8*s)-1;J(this,e,n,s,E,0)}let p=1,g=0;for(this[n]=e&255;++g<s&&(p*=256);)this[n+g]=e/p&255;return n+s},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,n,s,a){if(e=+e,n=n>>>0,s=s>>>0,!a){const E=Math.pow(2,8*s)-1;J(this,e,n,s,E,0)}let p=s-1,g=1;for(this[n+p]=e&255;--p>=0&&(g*=256);)this[n+p]=e/g&255;return n+s},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,1,255,0),this[n]=e&255,n+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,2,65535,0),this[n]=e&255,this[n+1]=e>>>8,n+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,2,65535,0),this[n]=e>>>8,this[n+1]=e&255,n+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,4,4294967295,0),this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=e&255,n+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,4,4294967295,0),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e&255,n+4};function Pt(o,e,n,s,a){Nt(e,s,a,o,n,7);let p=Number(e&BigInt(4294967295));o[n++]=p,p=p>>8,o[n++]=p,p=p>>8,o[n++]=p,p=p>>8,o[n++]=p;let g=Number(e>>BigInt(32)&BigInt(4294967295));return o[n++]=g,g=g>>8,o[n++]=g,g=g>>8,o[n++]=g,g=g>>8,o[n++]=g,n}function Ut(o,e,n,s,a){Nt(e,s,a,o,n,7);let p=Number(e&BigInt(4294967295));o[n+7]=p,p=p>>8,o[n+6]=p,p=p>>8,o[n+5]=p,p=p>>8,o[n+4]=p;let g=Number(e>>BigInt(32)&BigInt(4294967295));return o[n+3]=g,g=g>>8,o[n+2]=g,g=g>>8,o[n+1]=g,g=g>>8,o[n]=g,n+8}u.prototype.writeBigUInt64LE=H(function(e,n=0){return Pt(this,e,n,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=H(function(e,n=0){return Ut(this,e,n,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(e,n,s,a){if(e=+e,n=n>>>0,!a){const Z=Math.pow(2,8*s-1);J(this,e,n,s,Z-1,-Z)}let p=0,g=1,E=0;for(this[n]=e&255;++p<s&&(g*=256);)e<0&&E===0&&this[n+p-1]!==0&&(E=1),this[n+p]=(e/g>>0)-E&255;return n+s},u.prototype.writeIntBE=function(e,n,s,a){if(e=+e,n=n>>>0,!a){const Z=Math.pow(2,8*s-1);J(this,e,n,s,Z-1,-Z)}let p=s-1,g=1,E=0;for(this[n+p]=e&255;--p>=0&&(g*=256);)e<0&&E===0&&this[n+p+1]!==0&&(E=1),this[n+p]=(e/g>>0)-E&255;return n+s},u.prototype.writeInt8=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,1,127,-128),e<0&&(e=255+e+1),this[n]=e&255,n+1},u.prototype.writeInt16LE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,2,32767,-32768),this[n]=e&255,this[n+1]=e>>>8,n+2},u.prototype.writeInt16BE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,2,32767,-32768),this[n]=e>>>8,this[n+1]=e&255,n+2},u.prototype.writeInt32LE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,4,2147483647,-2147483648),this[n]=e&255,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24,n+4},u.prototype.writeInt32BE=function(e,n,s){return e=+e,n=n>>>0,s||J(this,e,n,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e&255,n+4},u.prototype.writeBigInt64LE=H(function(e,n=0){return Pt(this,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=H(function(e,n=0){return Ut(this,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Rt(o,e,n,s,a,p){if(n+s>o.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Zt(o,e,n,s,a){return e=+e,n=n>>>0,a||Rt(o,e,n,4),i.write(o,e,n,s,23,4),n+4}u.prototype.writeFloatLE=function(e,n,s){return Zt(this,e,n,!0,s)},u.prototype.writeFloatBE=function(e,n,s){return Zt(this,e,n,!1,s)};function Lt(o,e,n,s,a){return e=+e,n=n>>>0,a||Rt(o,e,n,8),i.write(o,e,n,s,52,8),n+8}u.prototype.writeDoubleLE=function(e,n,s){return Lt(this,e,n,!0,s)},u.prototype.writeDoubleBE=function(e,n,s){return Lt(this,e,n,!1,s)},u.prototype.copy=function(e,n,s,a){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(s||(s=0),!a&&a!==0&&(a=this.length),n>=e.length&&(n=e.length),n||(n=0),a>0&&a<s&&(a=s),a===s||e.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-n<a-s&&(a=e.length-n+s);const p=a-s;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(n,s,a):Uint8Array.prototype.set.call(e,this.subarray(s,a),n),p},u.prototype.fill=function(e,n,s,a){if(typeof e=="string"){if(typeof n=="string"?(a=n,n=0,s=this.length):typeof s=="string"&&(a=s,s=this.length),a!==void 0&&typeof a!="string")throw new TypeError("encoding must be a string");if(typeof a=="string"&&!u.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(e.length===1){const g=e.charCodeAt(0);(a==="utf8"&&g<128||a==="latin1")&&(e=g)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(n<0||this.length<n||this.length<s)throw new RangeError("Out of range index");if(s<=n)return this;n=n>>>0,s=s===void 0?this.length:s>>>0,e||(e=0);let p;if(typeof e=="number")for(p=n;p<s;++p)this[p]=e;else{const g=u.isBuffer(e)?e:u.from(e,a),E=g.length;if(E===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(p=0;p<s-n;++p)this[p+n]=g[p%E]}return this};const j={};function yt(o,e,n){j[o]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${o}]`,this.stack,delete this.name}get code(){return o}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${o}]: ${this.message}`}}}yt("ERR_BUFFER_OUT_OF_BOUNDS",function(o){return o?`${o} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),yt("ERR_INVALID_ARG_TYPE",function(o,e){return`The "${o}" argument must be of type number. Received type ${typeof e}`},TypeError),yt("ERR_OUT_OF_RANGE",function(o,e,n){let s=`The value of "${o}" is out of range.`,a=n;return Number.isInteger(n)&&Math.abs(n)>2**32?a=Wt(String(n)):typeof n=="bigint"&&(a=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(a=Wt(a)),a+="n"),s+=` It must be ${e}. Received ${a}`,s},RangeError);function Wt(o){let e="",n=o.length;const s=o[0]==="-"?1:0;for(;n>=s+4;n-=3)e=`_${o.slice(n-3,n)}${e}`;return`${o.slice(0,n)}${e}`}function Er(o,e,n){tt(e,"offset"),(o[e]===void 0||o[e+n]===void 0)&&ot(e,o.length-(n+1))}function Nt(o,e,n,s,a,p){if(o>n||o<e){const g=typeof e=="bigint"?"n":"";let E;throw p>3?e===0||e===BigInt(0)?E=`>= 0${g} and < 2${g} ** ${(p+1)*8}${g}`:E=`>= -(2${g} ** ${(p+1)*8-1}${g}) and < 2 ** ${(p+1)*8-1}${g}`:E=`>= ${e}${g} and <= ${n}${g}`,new j.ERR_OUT_OF_RANGE("value",E,o)}Er(s,a,p)}function tt(o,e){if(typeof o!="number")throw new j.ERR_INVALID_ARG_TYPE(e,"number",o)}function ot(o,e,n){throw Math.floor(o)!==o?(tt(o,n),new j.ERR_OUT_OF_RANGE(n||"offset","an integer",o)):e<0?new j.ERR_BUFFER_OUT_OF_BOUNDS:new j.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,o)}const kr=/[^+/0-9A-Za-z-_]/g;function Ir(o){if(o=o.split("=")[0],o=o.trim().replace(kr,""),o.length<2)return"";for(;o.length%4!==0;)o=o+"=";return o}function dt(o,e){e=e||1/0;let n;const s=o.length;let a=null;const p=[];for(let g=0;g<s;++g){if(n=o.charCodeAt(g),n>55295&&n<57344){if(!a){if(n>56319){(e-=3)>-1&&p.push(239,191,189);continue}else if(g+1===s){(e-=3)>-1&&p.push(239,191,189);continue}a=n;continue}if(n<56320){(e-=3)>-1&&p.push(239,191,189),a=n;continue}n=(a-55296<<10|n-56320)+65536}else a&&(e-=3)>-1&&p.push(239,191,189);if(a=null,n<128){if((e-=1)<0)break;p.push(n)}else if(n<2048){if((e-=2)<0)break;p.push(n>>6|192,n&63|128)}else if(n<65536){if((e-=3)<0)break;p.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((e-=4)<0)break;p.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return p}function br(o){const e=[];for(let n=0;n<o.length;++n)e.push(o.charCodeAt(n)&255);return e}function Br(o,e){let n,s,a;const p=[];for(let g=0;g<o.length&&!((e-=2)<0);++g)n=o.charCodeAt(g),s=n>>8,a=n%256,p.push(a),p.push(s);return p}function At(o){return r.toByteArray(Ir(o))}function at(o,e,n,s){let a;for(a=0;a<s&&!(a+n>=e.length||a>=o.length);++a)e[a+n]=o[a];return a}function v(o,e){return o instanceof e||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===e.name}function xt(o){return o!==o}const Mr=function(){const o="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const s=n*16;for(let a=0;a<16;++a)e[s+a]=o[n]+o[a]}return e}();function H(o){return typeof BigInt>"u"?Sr:o}function Sr(){throw new Error("BigInt not supported")}})(I);const w={wkt:{Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION"},wkb:{Point:1,LineString:2,Polygon:3,MultiPoint:4,MultiLineString:5,MultiPolygon:6,GeometryCollection:7},geoJSON:{Point:"Point",LineString:"LineString",Polygon:"Polygon",MultiPoint:"MultiPoint",MultiLineString:"MultiLineString",MultiPolygon:"MultiPolygon",GeometryCollection:"GeometryCollection"}};function er(t){return t<<1^t>>31}function nr(t){return t>>1^-(t&1)}const A={encode:er,decode:nr};function C(t,r){this.buffer=t,this.position=0,this.isBigEndian=r||!1}function $(t,r,i){return function(){var h;return this.isBigEndian?h=r.call(this.buffer,this.position):h=t.call(this.buffer,this.position),this.position+=i,h}}C.prototype.readUInt8=$(I.Buffer.prototype.readUInt8,I.Buffer.prototype.readUInt8,1),C.prototype.readUInt16=$(I.Buffer.prototype.readUInt16LE,I.Buffer.prototype.readUInt16BE,2),C.prototype.readUInt32=$(I.Buffer.prototype.readUInt32LE,I.Buffer.prototype.readUInt32BE,4),C.prototype.readInt8=$(I.Buffer.prototype.readInt8,I.Buffer.prototype.readInt8,1),C.prototype.readInt16=$(I.Buffer.prototype.readInt16LE,I.Buffer.prototype.readInt16BE,2),C.prototype.readInt32=$(I.Buffer.prototype.readInt32LE,I.Buffer.prototype.readInt32BE,4),C.prototype.readFloat=$(I.Buffer.prototype.readFloatLE,I.Buffer.prototype.readFloatBE,4),C.prototype.readDouble=$(I.Buffer.prototype.readDoubleLE,I.Buffer.prototype.readDoubleBE,8),C.prototype.readVarInt=function(){var t,r=0,i=0;do t=this.buffer[this.position+i],r+=(t&127)<<7*i,i++;while(t>=128);return this.position+=i,r};function b(t,r){this.buffer=new I.Buffer(t),this.position=0,this.allowResize=r}function G(t,r){return function(i,h){this.ensureSize(r),t.call(this.buffer,i,this.position,h),this.position+=r}}b.prototype.writeUInt8=G(I.Buffer.prototype.writeUInt8,1),b.prototype.writeUInt16LE=G(I.Buffer.prototype.writeUInt16LE,2),b.prototype.writeUInt16BE=G(I.Buffer.prototype.writeUInt16BE,2),b.prototype.writeUInt32LE=G(I.Buffer.prototype.writeUInt32LE,4),b.prototype.writeUInt32BE=G(I.Buffer.prototype.writeUInt32BE,4),b.prototype.writeInt8=G(I.Buffer.prototype.writeInt8,1),b.prototype.writeInt16LE=G(I.Buffer.prototype.writeInt16LE,2),b.prototype.writeInt16BE=G(I.Buffer.prototype.writeInt16BE,2),b.prototype.writeInt32LE=G(I.Buffer.prototype.writeInt32LE,4),b.prototype.writeInt32BE=G(I.Buffer.prototype.writeInt32BE,4),b.prototype.writeFloatLE=G(I.Buffer.prototype.writeFloatLE,4),b.prototype.writeFloatBE=G(I.Buffer.prototype.writeFloatBE,4),b.prototype.writeDoubleLE=G(I.Buffer.prototype.writeDoubleLE,8),b.prototype.writeDoubleBE=G(I.Buffer.prototype.writeDoubleBE,8),b.prototype.writeBuffer=function(t){this.ensureSize(t.length),t.copy(this.buffer,this.position,0,t.length),this.position+=t.length},b.prototype.writeVarInt=function(t){for(var r=1;t&4294967168;)this.writeUInt8(t&127|128),t>>>=7,r++;return this.writeUInt8(t&127),r},b.prototype.ensureSize=function(t){if(this.buffer.length<this.position+t)if(this.allowResize){var r=new I.Buffer(this.position+t);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r}else throw new RangeError("index out of range")};function x(){this.srid=void 0,this.hasZ=!1,this.hasM=!1}x.parse=function(t,r){var i=typeof t;if(i==="string"||t instanceof z)return x._parseWkt(t);if(I.Buffer.isBuffer(t)||t instanceof C)return x._parseWkb(t,r);throw new Error("first argument must be a string or Buffer")},x._parseWkt=function(t){var r,i;t instanceof z?r=t:r=new z(t);var h=r.matchRegex([/^SRID=(\d+);/]);h&&(i=parseInt(h[1],10));var f=r.matchType(),c=r.matchDimension(),l={srid:i,hasZ:c.hasZ,hasM:c.hasM};switch(f){case w.wkt.Point:return y._parseWkt(r,l);case w.wkt.LineString:return M._parseWkt(r,l);case w.wkt.Polygon:return S._parseWkt(r,l);case w.wkt.MultiPoint:return P._parseWkt(r,l);case w.wkt.MultiLineString:return F._parseWkt(r,l);case w.wkt.MultiPolygon:return U._parseWkt(r,l);case w.wkt.GeometryCollection:return T._parseWkt(r,l)}},x._parseWkb=function(t,r){var i,h,f,c={};switch(t instanceof C?i=t:i=new C(t),i.isBigEndian=!i.readInt8(),h=i.readUInt32(),c.hasSrid=(h&536870912)===536870912,c.isEwkb=h&536870912||h&1073741824||h&2147483648,c.hasSrid&&(c.srid=i.readUInt32()),c.hasZ=!1,c.hasM=!1,!c.isEwkb&&(!r||!r.isEwkb)?h>=1e3&&h<2e3?(c.hasZ=!0,f=h-1e3):h>=2e3&&h<3e3?(c.hasM=!0,f=h-2e3):h>=3e3&&h<4e3?(c.hasZ=!0,c.hasM=!0,f=h-3e3):f=h:(h&2147483648&&(c.hasZ=!0),h&1073741824&&(c.hasM=!0),f=h&15),f){case w.wkb.Point:return y._parseWkb(i,c);case w.wkb.LineString:return M._parseWkb(i,c);case w.wkb.Polygon:return S._parseWkb(i,c);case w.wkb.MultiPoint:return P._parseWkb(i,c);case w.wkb.MultiLineString:return F._parseWkb(i,c);case w.wkb.MultiPolygon:return U._parseWkb(i,c);case w.wkb.GeometryCollection:return T._parseWkb(i,c);default:throw new Error("GeometryType "+f+" not supported")}},x.parseTwkb=function(t){var r,i={};t instanceof C?r=t:r=new C(t);var h=r.readUInt8(),f=r.readUInt8(),c=h&15;if(i.precision=A.decode(h>>4),i.precisionFactor=Math.pow(10,i.precision),i.hasBoundingBox=f>>0&1,i.hasSizeAttribute=f>>1&1,i.hasIdList=f>>2&1,i.hasExtendedPrecision=f>>3&1,i.isEmpty=f>>4&1,i.hasExtendedPrecision){var l=r.readUInt8();i.hasZ=(l&1)===1,i.hasM=(l&2)===2,i.zPrecision=A.decode((l&28)>>2),i.zPrecisionFactor=Math.pow(10,i.zPrecision),i.mPrecision=A.decode((l&224)>>5),i.mPrecisionFactor=Math.pow(10,i.mPrecision)}else i.hasZ=!1,i.hasM=!1;if(i.hasSizeAttribute&&r.readVarInt(),i.hasBoundingBox){var u=2;i.hasZ&&u++,i.hasM&&u++;for(var d=0;d<u;d++)r.readVarInt(),r.readVarInt()}switch(c){case w.wkb.Point:return y._parseTwkb(r,i);case w.wkb.LineString:return M._parseTwkb(r,i);case w.wkb.Polygon:return S._parseTwkb(r,i);case w.wkb.MultiPoint:return P._parseTwkb(r,i);case w.wkb.MultiLineString:return F._parseTwkb(r,i);case w.wkb.MultiPolygon:return U._parseTwkb(r,i);case w.wkb.GeometryCollection:return T._parseTwkb(r,i);default:throw new Error("GeometryType "+c+" not supported")}},x.parseGeoJSON=function(t){return x._parseGeoJSON(t)},x._parseGeoJSON=function(t,r){var i;switch(t.type){case w.geoJSON.Point:i=y._parseGeoJSON(t);break;case w.geoJSON.LineString:i=M._parseGeoJSON(t);break;case w.geoJSON.Polygon:i=S._parseGeoJSON(t);break;case w.geoJSON.MultiPoint:i=P._parseGeoJSON(t);break;case w.geoJSON.MultiLineString:i=F._parseGeoJSON(t);break;case w.geoJSON.MultiPolygon:i=U._parseGeoJSON(t);break;case w.geoJSON.GeometryCollection:i=T._parseGeoJSON(t);break;default:throw new Error("GeometryType "+t.type+" not supported")}if(t.crs&&t.crs.type&&t.crs.type==="name"&&t.crs.properties&&t.crs.properties.name){var h=t.crs.properties.name;if(h.indexOf("EPSG:")===0)i.srid=parseInt(h.substring(5));else if(h.indexOf("urn:ogc:def:crs:EPSG::")===0)i.srid=parseInt(h.substring(22));else throw new Error("Unsupported crs: "+h)}else r||(i.srid=4326);return i},x.prototype.toEwkt=function(){return"SRID="+this.srid+";"+this.toWkt()},x.prototype.toEwkb=function(){var t=new b(this._getWkbSize()+4),r=this.toWkb();return t.writeInt8(1),t.writeUInt32LE((r.slice(1,5).readUInt32LE(0)|536870912)>>>0,!0),t.writeUInt32LE(this.srid),t.writeBuffer(r.slice(5)),t.buffer},x.prototype._getWktType=function(t,r){var i=t;return this.hasZ&&this.hasM?i+=" ZM ":this.hasZ?i+=" Z ":this.hasM&&(i+=" M "),r&&!this.hasZ&&!this.hasM&&(i+=" "),r&&(i+="EMPTY"),i},x.prototype._getWktCoordinate=function(t){var r=t.x+" "+t.y;return this.hasZ&&(r+=" "+t.z),this.hasM&&(r+=" "+t.m),r},x.prototype._writeWkbType=function(t,r,i){var h=0;typeof this.srid>"u"&&(!i||typeof i.srid>"u")?this.hasZ&&this.hasM?h+=3e3:this.hasZ?h+=1e3:this.hasM&&(h+=2e3):(this.hasZ&&(h|=2147483648),this.hasM&&(h|=1073741824)),t.writeUInt32LE(h+r>>>0,!0)},x.getTwkbPrecision=function(t,r,i){return{xy:t,z:r,m:i,xyFactor:Math.pow(10,t),zFactor:Math.pow(10,r),mFactor:Math.pow(10,i)}},x.prototype._writeTwkbHeader=function(t,r,i,h){var f=(A.encode(i.xy)<<4)+r,c=(this.hasZ||this.hasM)<<3;if(c+=h<<4,t.writeUInt8(f),t.writeUInt8(c),this.hasZ||this.hasM){var l=0;this.hasZ&&(l|=1),this.hasM&&(l|=2),t.writeUInt8(l)}},x.prototype.toGeoJSON=function(t){var r={};return this.srid&&t&&(t.shortCrs?r.crs={type:"name",properties:{name:"EPSG:"+this.srid}}:t.longCrs&&(r.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+this.srid}})),r};function T(t,r){x.call(this),this.geometries=t||[],this.srid=r,this.geometries.length>0&&(this.hasZ=this.geometries[0].hasZ,this.hasM=this.geometries[0].hasM)}q(T,x),T.Z=function(t,r){var i=new T(t,r);return i.hasZ=!0,i},T.M=function(t,r){var i=new T(t,r);return i.hasM=!0,i},T.ZM=function(t,r){var i=new T(t,r);return i.hasZ=!0,i.hasM=!0,i},T._parseWkt=function(t,r){var i=new T;if(i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"]))return i;t.expectGroupStart();do i.geometries.push(x.parse(t));while(t.isMatch([","]));return t.expectGroupEnd(),i},T._parseWkb=function(t,r){var i=new T;i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM;for(var h=t.readUInt32(),f=0;f<h;f++)i.geometries.push(x.parse(t,r));return i},T._parseTwkb=function(t,r){var i=new T;if(i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty)return i;for(var h=t.readVarInt(),f=0;f<h;f++)i.geometries.push(x.parseTwkb(t));return i},T._parseGeoJSON=function(t){for(var r=new T,i=0;i<t.geometries.length;i++)r.geometries.push(x._parseGeoJSON(t.geometries[i],!0));return r.geometries.length>0&&(r.hasZ=r.geometries[0].hasZ),r},T.prototype.toWkt=function(){if(this.geometries.length===0)return this._getWktType(w.wkt.GeometryCollection,!0);for(var t=this._getWktType(w.wkt.GeometryCollection,!1)+"(",r=0;r<this.geometries.length;r++)t+=this.geometries[r].toWkt()+",";return t=t.slice(0,-1),t+=")",t},T.prototype.toWkb=function(){var t=new b(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,w.wkb.GeometryCollection),t.writeUInt32LE(this.geometries.length);for(var r=0;r<this.geometries.length;r++)t.writeBuffer(this.geometries[r].toWkb({srid:this.srid}));return t.buffer},T.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=this.geometries.length===0;if(this._writeTwkbHeader(t,w.wkb.GeometryCollection,r,i),this.geometries.length>0){t.writeVarInt(this.geometries.length);for(var h=0;h<this.geometries.length;h++)t.writeBuffer(this.geometries[h].toTwkb())}return t.buffer},T.prototype._getWkbSize=function(){for(var t=9,r=0;r<this.geometries.length;r++)t+=this.geometries[r]._getWkbSize();return t},T.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);r.type=w.geoJSON.GeometryCollection,r.geometries=[];for(var i=0;i<this.geometries.length;i++)r.geometries.push(this.geometries[i].toGeoJSON());return r};function M(t,r){x.call(this),this.points=t||[],this.srid=r,this.points.length>0&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}q(M,x),M.Z=function(t,r){var i=new M(t,r);return i.hasZ=!0,i},M.M=function(t,r){var i=new M(t,r);return i.hasM=!0,i},M.ZM=function(t,r){var i=new M(t,r);return i.hasZ=!0,i.hasM=!0,i},M._parseWkt=function(t,r){var i=new M;return i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),i.points.push.apply(i.points,t.matchCoordinates(r)),t.expectGroupEnd()),i},M._parseWkb=function(t,r){var i=new M;i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM;for(var h=t.readUInt32(),f=0;f<h;f++)i.points.push(y._readWkbPoint(t,r));return i},M._parseTwkb=function(t,r){var i=new M;if(i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty)return i;for(var h=new y(0,0,r.hasZ?0:void 0,r.hasM?0:void 0),f=t.readVarInt(),c=0;c<f;c++)i.points.push(y._readTwkbPoint(t,r,h));return i},M._parseGeoJSON=function(t){var r=new M;t.coordinates.length>0&&(r.hasZ=t.coordinates[0].length>2);for(var i=0;i<t.coordinates.length;i++)r.points.push(y._readGeoJSONPoint(t.coordinates[i]));return r},M.prototype.toWkt=function(){return this.points.length===0?this._getWktType(w.wkt.LineString,!0):this._getWktType(w.wkt.LineString,!1)+this._toInnerWkt()},M.prototype._toInnerWkt=function(){for(var t="(",r=0;r<this.points.length;r++)t+=this._getWktCoordinate(this.points[r])+",";return t=t.slice(0,-1),t+=")",t},M.prototype.toWkb=function(t){var r=new b(this._getWkbSize());r.writeInt8(1),this._writeWkbType(r,w.wkb.LineString,t),r.writeUInt32LE(this.points.length);for(var i=0;i<this.points.length;i++)this.points[i]._writeWkbPoint(r);return r.buffer},M.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=this.points.length===0;if(this._writeTwkbHeader(t,w.wkb.LineString,r,i),this.points.length>0){t.writeVarInt(this.points.length);for(var h=new y(0,0,0,0),f=0;f<this.points.length;f++)this.points[f]._writeTwkbPoint(t,r,h)}return t.buffer},M.prototype._getWkbSize=function(){var t=16;return this.hasZ&&(t+=8),this.hasM&&(t+=8),1+4+4+this.points.length*t},M.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);r.type=w.geoJSON.LineString,r.coordinates=[];for(var i=0;i<this.points.length;i++)this.hasZ?r.coordinates.push([this.points[i].x,this.points[i].y,this.points[i].z]):r.coordinates.push([this.points[i].x,this.points[i].y]);return r};function F(t,r){x.call(this),this.lineStrings=t||[],this.srid=r,this.lineStrings.length>0&&(this.hasZ=this.lineStrings[0].hasZ,this.hasM=this.lineStrings[0].hasM)}q(F,x),F.Z=function(t,r){var i=new F(t,r);return i.hasZ=!0,i},F.M=function(t,r){var i=new F(t,r);return i.hasM=!0,i},F.ZM=function(t,r){var i=new F(t,r);return i.hasZ=!0,i.hasM=!0,i},F._parseWkt=function(t,r){var i=new F;if(i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"]))return i;t.expectGroupStart();do t.expectGroupStart(),i.lineStrings.push(new M(t.matchCoordinates(r))),t.expectGroupEnd();while(t.isMatch([","]));return t.expectGroupEnd(),i},F._parseWkb=function(t,r){var i=new F;i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM;for(var h=t.readUInt32(),f=0;f<h;f++)i.lineStrings.push(x.parse(t,r));return i},F._parseTwkb=function(t,r){var i=new F;if(i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty)return i;for(var h=new y(0,0,r.hasZ?0:void 0,r.hasM?0:void 0),f=t.readVarInt(),c=0;c<f;c++){var l=new M;l.hasZ=r.hasZ,l.hasM=r.hasM;for(var u=t.readVarInt(),d=0;d<u;d++)l.points.push(y._readTwkbPoint(t,r,h));i.lineStrings.push(l)}return i},F._parseGeoJSON=function(t){var r=new F;t.coordinates.length>0&&t.coordinates[0].length>0&&(r.hasZ=t.coordinates[0][0].length>2);for(var i=0;i<t.coordinates.length;i++)r.lineStrings.push(M._parseGeoJSON({coordinates:t.coordinates[i]}));return r},F.prototype.toWkt=function(){if(this.lineStrings.length===0)return this._getWktType(w.wkt.MultiLineString,!0);for(var t=this._getWktType(w.wkt.MultiLineString,!1)+"(",r=0;r<this.lineStrings.length;r++)t+=this.lineStrings[r]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")",t},F.prototype.toWkb=function(){var t=new b(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,w.wkb.MultiLineString),t.writeUInt32LE(this.lineStrings.length);for(var r=0;r<this.lineStrings.length;r++)t.writeBuffer(this.lineStrings[r].toWkb({srid:this.srid}));return t.buffer},F.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=this.lineStrings.length===0;if(this._writeTwkbHeader(t,w.wkb.MultiLineString,r,i),this.lineStrings.length>0){t.writeVarInt(this.lineStrings.length);for(var h=new y(0,0,0,0),f=0;f<this.lineStrings.length;f++){t.writeVarInt(this.lineStrings[f].points.length);for(var c=0;c<this.lineStrings[f].points.length;c++)this.lineStrings[f].points[c]._writeTwkbPoint(t,r,h)}}return t.buffer},F.prototype._getWkbSize=function(){for(var t=9,r=0;r<this.lineStrings.length;r++)t+=this.lineStrings[r]._getWkbSize();return t},F.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);r.type=w.geoJSON.MultiLineString,r.coordinates=[];for(var i=0;i<this.lineStrings.length;i++)r.coordinates.push(this.lineStrings[i].toGeoJSON().coordinates);return r};function P(t,r){x.call(this),this.points=t||[],this.srid=r,this.points.length>0&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}q(P,x),P.Z=function(t,r){var i=new P(t,r);return i.hasZ=!0,i},P.M=function(t,r){var i=new P(t,r);return i.hasM=!0,i},P.ZM=function(t,r){var i=new P(t,r);return i.hasZ=!0,i.hasM=!0,i},P._parseWkt=function(t,r){var i=new P;return i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),i.points.push.apply(i.points,t.matchCoordinates(r)),t.expectGroupEnd()),i},P._parseWkb=function(t,r){var i=new P;i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM;for(var h=t.readUInt32(),f=0;f<h;f++)i.points.push(x.parse(t,r));return i},P._parseTwkb=function(t,r){var i=new P;if(i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty)return i;for(var h=new y(0,0,r.hasZ?0:void 0,r.hasM?0:void 0),f=t.readVarInt(),c=0;c<f;c++)i.points.push(y._readTwkbPoint(t,r,h));return i},P._parseGeoJSON=function(t){var r=new P;t.coordinates.length>0&&(r.hasZ=t.coordinates[0].length>2);for(var i=0;i<t.coordinates.length;i++)r.points.push(y._parseGeoJSON({coordinates:t.coordinates[i]}));return r},P.prototype.toWkt=function(){if(this.points.length===0)return this._getWktType(w.wkt.MultiPoint,!0);for(var t=this._getWktType(w.wkt.MultiPoint,!1)+"(",r=0;r<this.points.length;r++)t+=this._getWktCoordinate(this.points[r])+",";return t=t.slice(0,-1),t+=")",t},P.prototype.toWkb=function(){var t=new b(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,w.wkb.MultiPoint),t.writeUInt32LE(this.points.length);for(var r=0;r<this.points.length;r++)t.writeBuffer(this.points[r].toWkb({srid:this.srid}));return t.buffer},P.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=this.points.length===0;if(this._writeTwkbHeader(t,w.wkb.MultiPoint,r,i),this.points.length>0){t.writeVarInt(this.points.length);for(var h=new y(0,0,0,0),f=0;f<this.points.length;f++)this.points[f]._writeTwkbPoint(t,r,h)}return t.buffer},P.prototype._getWkbSize=function(){var t=16;return this.hasZ&&(t+=8),this.hasM&&(t+=8),t+=5,1+4+4+this.points.length*t},P.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);r.type=w.geoJSON.MultiPoint,r.coordinates=[];for(var i=0;i<this.points.length;i++)r.coordinates.push(this.points[i].toGeoJSON().coordinates);return r};function U(t,r){x.call(this),this.polygons=t||[],this.srid=r,this.polygons.length>0&&(this.hasZ=this.polygons[0].hasZ,this.hasM=this.polygons[0].hasM)}q(U,x),U.Z=function(t,r){var i=new U(t,r);return i.hasZ=!0,i},U.M=function(t,r){var i=new U(t,r);return i.hasM=!0,i},U.ZM=function(t,r){var i=new U(t,r);return i.hasZ=!0,i.hasM=!0,i},U._parseWkt=function(t,r){var i=new U;if(i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"]))return i;t.expectGroupStart();do{t.expectGroupStart();var h=[],f=[];for(t.expectGroupStart(),h.push.apply(h,t.matchCoordinates(r)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),f.push(t.matchCoordinates(r)),t.expectGroupEnd();i.polygons.push(new S(h,f)),t.expectGroupEnd()}while(t.isMatch([","]));return t.expectGroupEnd(),i},U._parseWkb=function(t,r){var i=new U;i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM;for(var h=t.readUInt32(),f=0;f<h;f++)i.polygons.push(x.parse(t,r));return i},U._parseTwkb=function(t,r){var i=new U;if(i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty)return i;for(var h=new y(0,0,r.hasZ?0:void 0,r.hasM?0:void 0),f=t.readVarInt(),c=0;c<f;c++){var l=new S;l.hasZ=r.hasZ,l.hasM=r.hasM;for(var u=t.readVarInt(),d=t.readVarInt(),k=0;k<d;k++)l.exteriorRing.push(y._readTwkbPoint(t,r,h));for(k=1;k<u;k++){for(var m=[],B=t.readVarInt(),N=0;N<B;N++)m.push(y._readTwkbPoint(t,r,h));l.interiorRings.push(m)}i.polygons.push(l)}return i},U._parseGeoJSON=function(t){var r=new U;t.coordinates.length>0&&t.coordinates[0].length>0&&t.coordinates[0][0].length>0&&(r.hasZ=t.coordinates[0][0][0].length>2);for(var i=0;i<t.coordinates.length;i++)r.polygons.push(S._parseGeoJSON({coordinates:t.coordinates[i]}));return r},U.prototype.toWkt=function(){if(this.polygons.length===0)return this._getWktType(w.wkt.MultiPolygon,!0);for(var t=this._getWktType(w.wkt.MultiPolygon,!1)+"(",r=0;r<this.polygons.length;r++)t+=this.polygons[r]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")",t},U.prototype.toWkb=function(){var t=new b(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,w.wkb.MultiPolygon),t.writeUInt32LE(this.polygons.length);for(var r=0;r<this.polygons.length;r++)t.writeBuffer(this.polygons[r].toWkb({srid:this.srid}));return t.buffer},U.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=this.polygons.length===0;if(this._writeTwkbHeader(t,w.wkb.MultiPolygon,r,i),this.polygons.length>0){t.writeVarInt(this.polygons.length);for(var h=new y(0,0,0,0),f=0;f<this.polygons.length;f++){t.writeVarInt(1+this.polygons[f].interiorRings.length),t.writeVarInt(this.polygons[f].exteriorRing.length);for(var c=0;c<this.polygons[f].exteriorRing.length;c++)this.polygons[f].exteriorRing[c]._writeTwkbPoint(t,r,h);for(c=0;c<this.polygons[f].interiorRings.length;c++){t.writeVarInt(this.polygons[f].interiorRings[c].length);for(var l=0;l<this.polygons[f].interiorRings[c].length;l++)this.polygons[f].interiorRings[c][l]._writeTwkbPoint(t,r,h)}}}return t.buffer},U.prototype._getWkbSize=function(){for(var t=9,r=0;r<this.polygons.length;r++)t+=this.polygons[r]._getWkbSize();return t},U.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);r.type=w.geoJSON.MultiPolygon,r.coordinates=[];for(var i=0;i<this.polygons.length;i++)r.coordinates.push(this.polygons[i].toGeoJSON().coordinates);return r};function y(t,r,i,h,f){x.call(this),this.x=t,this.y=r,this.z=i,this.m=h,this.srid=f,this.hasZ=typeof this.z<"u",this.hasM=typeof this.m<"u"}q(y,x),y.Z=function(t,r,i,h){var f=new y(t,r,i,void 0,h);return f.hasZ=!0,f},y.M=function(t,r,i,h){var f=new y(t,r,void 0,i,h);return f.hasM=!0,f},y.ZM=function(t,r,i,h,f){var c=new y(t,r,i,h,f);return c.hasZ=!0,c.hasM=!0,c},y._parseWkt=function(t,r){var i=new y;if(i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"]))return i;t.expectGroupStart();var h=t.matchCoordinate(r);return i.x=h.x,i.y=h.y,i.z=h.z,i.m=h.m,t.expectGroupEnd(),i},y._parseWkb=function(t,r){var i=y._readWkbPoint(t,r);return i.srid=r.srid,i},y._readWkbPoint=function(t,r){return new y(t.readDouble(),t.readDouble(),r.hasZ?t.readDouble():void 0,r.hasM?t.readDouble():void 0)},y._parseTwkb=function(t,r){var i=new y;return i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty||(i.x=A.decode(t.readVarInt())/r.precisionFactor,i.y=A.decode(t.readVarInt())/r.precisionFactor,i.z=r.hasZ?A.decode(t.readVarInt())/r.zPrecisionFactor:void 0,i.m=r.hasM?A.decode(t.readVarInt())/r.mPrecisionFactor:void 0),i},y._readTwkbPoint=function(t,r,i){return i.x+=A.decode(t.readVarInt())/r.precisionFactor,i.y+=A.decode(t.readVarInt())/r.precisionFactor,r.hasZ&&(i.z+=A.decode(t.readVarInt())/r.zPrecisionFactor),r.hasM&&(i.m+=A.decode(t.readVarInt())/r.mPrecisionFactor),new y(i.x,i.y,i.z,i.m)},y._parseGeoJSON=function(t){return y._readGeoJSONPoint(t.coordinates)},y._readGeoJSONPoint=function(t){return t.length===0?new y:t.length>2?new y(t[0],t[1],t[2]):new y(t[0],t[1])},y.prototype.toWkt=function(){return typeof this.x>"u"&&typeof this.y>"u"&&typeof this.z>"u"&&typeof this.m>"u"?this._getWktType(w.wkt.Point,!0):this._getWktType(w.wkt.Point,!1)+"("+this._getWktCoordinate(this)+")"},y.prototype.toWkb=function(t){var r=new b(this._getWkbSize());return r.writeInt8(1),this._writeWkbType(r,w.wkb.Point,t),typeof this.x>"u"&&typeof this.y>"u"?(r.writeDoubleLE(NaN),r.writeDoubleLE(NaN),this.hasZ&&r.writeDoubleLE(NaN),this.hasM&&r.writeDoubleLE(NaN)):this._writeWkbPoint(r),r.buffer},y.prototype._writeWkbPoint=function(t){t.writeDoubleLE(this.x),t.writeDoubleLE(this.y),this.hasZ&&t.writeDoubleLE(this.z),this.hasM&&t.writeDoubleLE(this.m)},y.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=typeof this.x>"u"&&typeof this.y>"u";return this._writeTwkbHeader(t,w.wkb.Point,r,i),i||this._writeTwkbPoint(t,r,new y(0,0,0,0)),t.buffer},y.prototype._writeTwkbPoint=function(t,r,i){var h=this.x*r.xyFactor,f=this.y*r.xyFactor,c=this.z*r.zFactor,l=this.m*r.mFactor;t.writeVarInt(A.encode(h-i.x)),t.writeVarInt(A.encode(f-i.y)),this.hasZ&&t.writeVarInt(A.encode(c-i.z)),this.hasM&&t.writeVarInt(A.encode(l-i.m)),i.x=h,i.y=f,i.z=c,i.m=l},y.prototype._getWkbSize=function(){var t=21;return this.hasZ&&(t+=8),this.hasM&&(t+=8),t},y.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);return r.type=w.geoJSON.Point,typeof this.x>"u"&&typeof this.y>"u"?r.coordinates=[]:typeof this.z<"u"?r.coordinates=[this.x,this.y,this.z]:r.coordinates=[this.x,this.y],r};function S(t,r,i){x.call(this),this.exteriorRing=t||[],this.interiorRings=r||[],this.srid=i,this.exteriorRing.length>0&&(this.hasZ=this.exteriorRing[0].hasZ,this.hasM=this.exteriorRing[0].hasM)}q(S,x),S.Z=function(t,r,i){var h=new S(t,r,i);return h.hasZ=!0,h},S.M=function(t,r,i){var h=new S(t,r,i);return h.hasM=!0,h},S.ZM=function(t,r,i){var h=new S(t,r,i);return h.hasZ=!0,h.hasM=!0,h},S._parseWkt=function(t,r){var i=new S;if(i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM,t.isMatch(["EMPTY"]))return i;for(t.expectGroupStart(),t.expectGroupStart(),i.exteriorRing.push.apply(i.exteriorRing,t.matchCoordinates(r)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),i.interiorRings.push(t.matchCoordinates(r)),t.expectGroupEnd();return t.expectGroupEnd(),i},S._parseWkb=function(t,r){var i=new S;i.srid=r.srid,i.hasZ=r.hasZ,i.hasM=r.hasM;var h=t.readUInt32();if(h>0){for(var f=t.readUInt32(),c=0;c<f;c++)i.exteriorRing.push(y._readWkbPoint(t,r));for(c=1;c<h;c++){for(var l=[],u=t.readUInt32(),d=0;d<u;d++)l.push(y._readWkbPoint(t,r));i.interiorRings.push(l)}}return i},S._parseTwkb=function(t,r){var i=new S;if(i.hasZ=r.hasZ,i.hasM=r.hasM,r.isEmpty)return i;for(var h=new y(0,0,r.hasZ?0:void 0,r.hasM?0:void 0),f=t.readVarInt(),c=t.readVarInt(),l=0;l<c;l++)i.exteriorRing.push(y._readTwkbPoint(t,r,h));for(l=1;l<f;l++){for(var u=[],d=t.readVarInt(),k=0;k<d;k++)u.push(y._readTwkbPoint(t,r,h));i.interiorRings.push(u)}return i},S._parseGeoJSON=function(t){var r=new S;t.coordinates.length>0&&t.coordinates[0].length>0&&(r.hasZ=t.coordinates[0][0].length>2);for(var i=0;i<t.coordinates.length;i++){i>0&&r.interiorRings.push([]);for(var h=0;h<t.coordinates[i].length;h++)i===0?r.exteriorRing.push(y._readGeoJSONPoint(t.coordinates[i][h])):r.interiorRings[i-1].push(y._readGeoJSONPoint(t.coordinates[i][h]))}return r},S.prototype.toWkt=function(){return this.exteriorRing.length===0?this._getWktType(w.wkt.Polygon,!0):this._getWktType(w.wkt.Polygon,!1)+this._toInnerWkt()},S.prototype._toInnerWkt=function(){for(var t="((",r=0;r<this.exteriorRing.length;r++)t+=this._getWktCoordinate(this.exteriorRing[r])+",";for(t=t.slice(0,-1),t+=")",r=0;r<this.interiorRings.length;r++){t+=",(";for(var i=0;i<this.interiorRings[r].length;i++)t+=this._getWktCoordinate(this.interiorRings[r][i])+",";t=t.slice(0,-1),t+=")"}return t+=")",t},S.prototype.toWkb=function(t){var r=new b(this._getWkbSize());r.writeInt8(1),this._writeWkbType(r,w.wkb.Polygon,t),this.exteriorRing.length>0?(r.writeUInt32LE(1+this.interiorRings.length),r.writeUInt32LE(this.exteriorRing.length)):r.writeUInt32LE(0);for(var i=0;i<this.exteriorRing.length;i++)this.exteriorRing[i]._writeWkbPoint(r);for(i=0;i<this.interiorRings.length;i++){r.writeUInt32LE(this.interiorRings[i].length);for(var h=0;h<this.interiorRings[i].length;h++)this.interiorRings[i][h]._writeWkbPoint(r)}return r.buffer},S.prototype.toTwkb=function(){var t=new b(0,!0),r=x.getTwkbPrecision(5,0,0),i=this.exteriorRing.length===0;if(this._writeTwkbHeader(t,w.wkb.Polygon,r,i),this.exteriorRing.length>0){t.writeVarInt(1+this.interiorRings.length),t.writeVarInt(this.exteriorRing.length);for(var h=new y(0,0,0,0),f=0;f<this.exteriorRing.length;f++)this.exteriorRing[f]._writeTwkbPoint(t,r,h);for(f=0;f<this.interiorRings.length;f++){t.writeVarInt(this.interiorRings[f].length);for(var c=0;c<this.interiorRings[f].length;c++)this.interiorRings[f][c]._writeTwkbPoint(t,r,h)}}return t.buffer},S.prototype._getWkbSize=function(){var t=16;this.hasZ&&(t+=8),this.hasM&&(t+=8);var r=1+4+4;this.exteriorRing.length>0&&(r+=4+this.exteriorRing.length*t);for(var i=0;i<this.interiorRings.length;i++)r+=4+this.interiorRings[i].length*t;return r},S.prototype.toGeoJSON=function(t){var r=x.prototype.toGeoJSON.call(this,t);if(r.type=w.geoJSON.Polygon,r.coordinates=[],this.exteriorRing.length>0){for(var i=[],h=0;h<this.exteriorRing.length;h++)this.hasZ?i.push([this.exteriorRing[h].x,this.exteriorRing[h].y,this.exteriorRing[h].z]):i.push([this.exteriorRing[h].x,this.exteriorRing[h].y]);r.coordinates.push(i)}for(var f=0;f<this.interiorRings.length;f++){for(var c=[],l=0;l<this.interiorRings[f].length;l++)this.hasZ?c.push([this.interiorRings[f][l].x,this.interiorRings[f][l].y,this.interiorRings[f][l].z]):c.push([this.interiorRings[f][l].x,this.interiorRings[f][l].y]);r.coordinates.push(c)}return r};function q(t,r){t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function z(t){this.value=t,this.position=0}z.prototype.match=function(t){this.skipWhitespaces();for(var r=0;r<t.length;r++)if(this.value.substring(this.position).indexOf(t[r])===0)return this.position+=t[r].length,t[r];return null},z.prototype.matchRegex=function(t){this.skipWhitespaces();for(var r=0;r<t.length;r++){var i=this.value.substring(this.position).match(t[r]);if(i)return this.position+=i[0].length,i}return null},z.prototype.isMatch=function(t){this.skipWhitespaces();for(var r=0;r<t.length;r++)if(this.value.substring(this.position).indexOf(t[r])===0)return this.position+=t[r].length,!0;return!1},z.prototype.matchType=function(){var t=this.match([w.wkt.Point,w.wkt.LineString,w.wkt.Polygon,w.wkt.MultiPoint,w.wkt.MultiLineString,w.wkt.MultiPolygon,w.wkt.GeometryCollection]);if(!t)throw new Error("Expected geometry type");return t},z.prototype.matchDimension=function(){var t=this.match(["ZM","Z","M"]);switch(t){case"ZM":return{hasZ:!0,hasM:!0};case"Z":return{hasZ:!0,hasM:!1};case"M":return{hasZ:!1,hasM:!0};default:return{hasZ:!1,hasM:!1}}},z.prototype.expectGroupStart=function(){if(!this.isMatch(["("]))throw new Error("Expected group start")},z.prototype.expectGroupEnd=function(){if(!this.isMatch([")"]))throw new Error("Expected group end")},z.prototype.matchCoordinate=function(t){var r;if(t.hasZ&&t.hasM?r=this.matchRegex([/^(\S*)\s+(\S*)\s+(\S*)\s+([^\s,)]*)/]):t.hasZ||t.hasM?r=this.matchRegex([/^(\S*)\s+(\S*)\s+([^\s,)]*)/]):r=this.matchRegex([/^(\S*)\s+([^\s,)]*)/]),!r)throw new Error("Expected coordinates");return t.hasZ&&t.hasM?new y(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]),parseFloat(r[4])):t.hasZ?new y(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])):t.hasM?new y(parseFloat(r[1]),parseFloat(r[2]),void 0,parseFloat(r[3])):new y(parseFloat(r[1]),parseFloat(r[2]))},z.prototype.matchCoordinates=function(t){var r=[];do{var i=this.isMatch(["("]);r.push(this.matchCoordinate(t)),i&&this.expectGroupEnd()}while(this.isMatch([","]));return r},z.prototype.skipWhitespaces=function(){for(;this.position<this.value.length&&this.value[this.position]===" ";)this.position++};const et={},ir={WKT:t=>r=>x.parse(r[t]).toGeoJSON(),WKB:t=>r=>(r[t]||console.warn("No geometry found in row",r),x._parseWkb(I.Buffer.from(r[t],"hex")).toGeoJSON()),GeoJSON:t=>r=>{const i=r[t];return typeof i=="string"?JSON.parse(i):i}},or=(t,r,i,h)=>{const f=ir[r](i);return h?c=>{const l=c[h];return et[t][l]||(et[t][l]=f(c)),et[t][l]}:c=>f(c)};ft({async convertToGeojsonLike(t,r,i,h,f){const c=`${t}/${h}`;et[c]||(et[c]={});const l=or(c,i,h,f),u=m=>m[h]!==null&&m[h]!==void 0,d=m=>({type:"Feature",geometry:l(m),properties:m}),k=[];for(const m of r)u(m)&&k.push(d(m));return k}})});
