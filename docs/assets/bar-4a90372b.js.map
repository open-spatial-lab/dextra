{"version":3,"file":"bar-4a90372b.js","sources":["../../node_modules/@observablehq/plot/src/marks/bar.js"],"sourcesContent":["import {create} from \"../context.js\";\nimport {Mark} from \"../mark.js\";\nimport {hasXY, identity, indexOf, number} from \"../options.js\";\nimport {isCollapsed} from \"../scales.js\";\nimport {applyAttr, applyChannelStyles, applyDirectStyles, applyIndirectStyles, applyTransform} from \"../style.js\";\nimport {impliedString} from \"../style.js\";\nimport {maybeIdentityX, maybeIdentityY} from \"../transforms/identity.js\";\nimport {maybeIntervalX, maybeIntervalY} from \"../transforms/interval.js\";\nimport {maybeStackX, maybeStackY} from \"../transforms/stack.js\";\n\nexport class AbstractBar extends Mark {\n  constructor(data, channels, options = {}, defaults) {\n    super(data, channels, options, defaults);\n    const {inset = 0, insetTop = inset, insetRight = inset, insetBottom = inset, insetLeft = inset, rx, ry} = options;\n    this.insetTop = number(insetTop);\n    this.insetRight = number(insetRight);\n    this.insetBottom = number(insetBottom);\n    this.insetLeft = number(insetLeft);\n    this.rx = impliedString(rx, \"auto\"); // number or percentage\n    this.ry = impliedString(ry, \"auto\");\n  }\n  render(index, scales, channels, dimensions, context) {\n    const {rx, ry} = this;\n    return create(\"svg:g\", context)\n      .call(applyIndirectStyles, this, dimensions, context)\n      .call(this._transform, this, scales)\n      .call((g) =>\n        g\n          .selectAll()\n          .data(index)\n          .enter()\n          .append(\"rect\")\n          .call(applyDirectStyles, this)\n          .attr(\"x\", this._x(scales, channels, dimensions))\n          .attr(\"width\", this._width(scales, channels, dimensions))\n          .attr(\"y\", this._y(scales, channels, dimensions))\n          .attr(\"height\", this._height(scales, channels, dimensions))\n          .call(applyAttr, \"rx\", rx)\n          .call(applyAttr, \"ry\", ry)\n          .call(applyChannelStyles, this, channels)\n      )\n      .node();\n  }\n  _x(scales, {x: X}, {marginLeft}) {\n    const {insetLeft} = this;\n    return X ? (i) => X[i] + insetLeft : marginLeft + insetLeft;\n  }\n  _y(scales, {y: Y}, {marginTop}) {\n    const {insetTop} = this;\n    return Y ? (i) => Y[i] + insetTop : marginTop + insetTop;\n  }\n  _width({x}, {x: X}, {marginRight, marginLeft, width}) {\n    const {insetLeft, insetRight} = this;\n    const bandwidth = X && x ? x.bandwidth() : width - marginRight - marginLeft;\n    return Math.max(0, bandwidth - insetLeft - insetRight);\n  }\n  _height({y}, {y: Y}, {marginTop, marginBottom, height}) {\n    const {insetTop, insetBottom} = this;\n    const bandwidth = Y && y ? y.bandwidth() : height - marginTop - marginBottom;\n    return Math.max(0, bandwidth - insetTop - insetBottom);\n  }\n}\n\nconst defaults = {\n  ariaLabel: \"bar\"\n};\n\nexport class BarX extends AbstractBar {\n  constructor(data, options = {}) {\n    const {x1, x2, y} = options;\n    super(\n      data,\n      {\n        x1: {value: x1, scale: \"x\"},\n        x2: {value: x2, scale: \"x\"},\n        y: {value: y, scale: \"y\", type: \"band\", optional: true}\n      },\n      options,\n      defaults\n    );\n  }\n  _transform(selection, mark, {x}) {\n    selection.call(applyTransform, mark, {x}, 0, 0);\n  }\n  _x({x}, {x1: X1, x2: X2}, {marginLeft}) {\n    const {insetLeft} = this;\n    return isCollapsed(x) ? marginLeft + insetLeft : (i) => Math.min(X1[i], X2[i]) + insetLeft;\n  }\n  _width({x}, {x1: X1, x2: X2}, {marginRight, marginLeft, width}) {\n    const {insetLeft, insetRight} = this;\n    return isCollapsed(x)\n      ? width - marginRight - marginLeft - insetLeft - insetRight\n      : (i) => Math.max(0, Math.abs(X2[i] - X1[i]) - insetLeft - insetRight);\n  }\n}\n\nexport class BarY extends AbstractBar {\n  constructor(data, options = {}) {\n    const {x, y1, y2} = options;\n    super(\n      data,\n      {\n        y1: {value: y1, scale: \"y\"},\n        y2: {value: y2, scale: \"y\"},\n        x: {value: x, scale: \"x\", type: \"band\", optional: true}\n      },\n      options,\n      defaults\n    );\n  }\n  _transform(selection, mark, {y}) {\n    selection.call(applyTransform, mark, {y}, 0, 0);\n  }\n  _y({y}, {y1: Y1, y2: Y2}, {marginTop}) {\n    const {insetTop} = this;\n    return isCollapsed(y) ? marginTop + insetTop : (i) => Math.min(Y1[i], Y2[i]) + insetTop;\n  }\n  _height({y}, {y1: Y1, y2: Y2}, {marginTop, marginBottom, height}) {\n    const {insetTop, insetBottom} = this;\n    return isCollapsed(y)\n      ? height - marginTop - marginBottom - insetTop - insetBottom\n      : (i) => Math.max(0, Math.abs(Y2[i] - Y1[i]) - insetTop - insetBottom);\n  }\n}\n\nexport function barX(data, options = {}) {\n  if (!hasXY(options)) options = {...options, y: indexOf, x2: identity};\n  return new BarX(data, maybeStackX(maybeIntervalX(maybeIdentityX(options))));\n}\n\nexport function barY(data, options = {}) {\n  if (!hasXY(options)) options = {...options, x: indexOf, y2: identity};\n  return new BarY(data, maybeStackY(maybeIntervalY(maybeIdentityY(options))));\n}\n"],"names":["AbstractBar","Mark","data","channels","options","defaults","inset","insetTop","insetRight","insetBottom","insetLeft","rx","ry","number","impliedString","index","scales","dimensions","context","create","applyIndirectStyles","g","applyDirectStyles","applyAttr","applyChannelStyles","X","marginLeft","i","Y","marginTop","x","marginRight","width","bandwidth","y","marginBottom","height","BarX","x1","x2","selection","mark","applyTransform","X1","X2","isCollapsed","BarY","y1","y2","Y1","Y2","barX","hasXY","indexOf","identity","maybeStackX","maybeIntervalX","maybeIdentityX","barY","maybeStackY","maybeIntervalY","maybeIdentityY"],"mappings":"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","x_google_ignoreList":[0]}