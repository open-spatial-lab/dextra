{"version":3,"file":"focusable-6e37aff0.js","sources":["../../node_modules/@spectrum-web-components/shared/src/focusable.js"],"sourcesContent":["\"use strict\";var u=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var n=(s,a,e,t)=>{for(var i=t>1?void 0:t?b(a,e):a,o=s.length-1,r;o>=0;o--)(r=s[o])&&(i=(t?r(a,e,i):r(i))||i);return t&&i&&u(a,e,i),i};import{SpectrumElement as h}from\"@spectrum-web-components/base\";import{property as l}from\"@spectrum-web-components/base/src/decorators.js\";import{FocusVisiblePolyfillMixin as c}from\"./focus-visible.js\";function d(){return new Promise(s=>requestAnimationFrame(()=>s()))}export class Focusable extends c(h){constructor(){super(...arguments);this.disabled=!1;this.autofocus=!1;this._tabIndex=-1;this.manipulatingTabindex=!1;this._recentlyConnected=!1}get tabIndex(){if(this.focusElement===this){const t=this.hasAttribute(\"tabindex\")?Number(this.getAttribute(\"tabindex\")):NaN;return isNaN(t)?-1:t}const e=parseFloat(this.hasAttribute(\"tabindex\")&&this.getAttribute(\"tabindex\")||\"0\");return this.disabled||e<0?-1:this.focusElement?this.focusElement.tabIndex:e}set tabIndex(e){if(this.manipulatingTabindex){this.manipulatingTabindex=!1;return}if(this.focusElement===this){if(e!==this._tabIndex){this._tabIndex=e;const t=this.disabled?\"-1\":\"\"+e;this.manipulatingTabindex=!0,this.setAttribute(\"tabindex\",t)}return}if(e===-1?this.addEventListener(\"pointerdown\",this.onPointerdownManagementOfTabIndex):(this.manipulatingTabindex=!0,this.removeEventListener(\"pointerdown\",this.onPointerdownManagementOfTabIndex)),e===-1||this.disabled){this.setAttribute(\"tabindex\",\"-1\"),this.removeAttribute(\"focusable\"),e!==-1&&this.manageFocusElementTabindex(e);return}this.setAttribute(\"focusable\",\"\"),this.hasAttribute(\"tabindex\")?this.removeAttribute(\"tabindex\"):this.manipulatingTabindex=!1,this.manageFocusElementTabindex(e)}onPointerdownManagementOfTabIndex(){this.tabIndex===-1&&(this.tabIndex=0,this.focus({preventScroll:!0}))}async manageFocusElementTabindex(e){this.focusElement||await this.updateComplete,e===null?this.focusElement.removeAttribute(\"tabindex\"):this.focusElement.tabIndex=e}get focusElement(){throw new Error(\"Must implement focusElement getter!\")}focus(e){this.disabled||!this.focusElement||(this.focusElement!==this?this.focusElement.focus(e):HTMLElement.prototype.focus.apply(this,[e]))}blur(){const e=this.focusElement||this;e!==this?e.blur():HTMLElement.prototype.blur.apply(this)}click(){if(this.disabled)return;const e=this.focusElement||this;e!==this?e.click():HTMLElement.prototype.click.apply(this)}manageAutoFocus(){this.autofocus&&(this.dispatchEvent(new KeyboardEvent(\"keydown\",{code:\"Tab\"})),this.focusElement.focus())}firstUpdated(e){super.firstUpdated(e),(!this.hasAttribute(\"tabindex\")||this.getAttribute(\"tabindex\")!==\"-1\")&&this.setAttribute(\"focusable\",\"\")}update(e){e.has(\"disabled\")&&this.handleDisabledChanged(this.disabled,e.get(\"disabled\")),super.update(e)}updated(e){super.updated(e),e.has(\"disabled\")&&this.disabled&&this.blur()}async handleDisabledChanged(e,t){const i=()=>this.focusElement!==this&&typeof this.focusElement.disabled!=\"undefined\";e?(this.manipulatingTabindex=!0,this.setAttribute(\"tabindex\",\"-1\"),await this.updateComplete,i()?this.focusElement.disabled=!0:this.setAttribute(\"aria-disabled\",\"true\")):t&&(this.manipulatingTabindex=!0,this.focusElement===this?this.setAttribute(\"tabindex\",\"\"+this._tabIndex):this.removeAttribute(\"tabindex\"),await this.updateComplete,i()?this.focusElement.disabled=!1:this.removeAttribute(\"aria-disabled\"))}async getUpdateComplete(){const e=await super.getUpdateComplete();return this._recentlyConnected&&(this._recentlyConnected=!1,await d(),await d()),e}connectedCallback(){super.connectedCallback(),this._recentlyConnected=!0,this.updateComplete.then(()=>{this.manageAutoFocus()})}}n([l({type:Boolean,reflect:!0})],Focusable.prototype,\"disabled\",2),n([l({type:Boolean})],Focusable.prototype,\"autofocus\",2),n([l({type:Number})],Focusable.prototype,\"tabIndex\",1);\n//# sourceMappingURL=focusable.js.map\n"],"names":["u","b","n","s","a","t","i","o","r","d","Focusable","c","h","e","l"],"mappings":"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","x_google_ignoreList":[0]}