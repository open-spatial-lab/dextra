import{x as F}from"./lit-element-47511895.js";import{s as Y,n as b}from"./safeCustomElement-f1504f3f.js";import{P as $}from"./PlotMark-3b7eceed.js";import{an as y,aD as j,aE as H,ah as Z,aF as G,at as J,N as K,$ as E,ap as Q,aG as U,aH as V,b as h,n as f,f as I,aI as L,M as W,aJ as v,d as tt,e as rt,g as nt,l as et,aK as ot,aL as T,C as st,B as at,aw as it,ax as ct,F as k,aM as lt,aN as q,aO as ut}from"./Plot-e459c07e.js";import{c as pt}from"./count-17af7dc7.js";import{a as mt,b as ft}from"./bar-4a90372b.js";import{d as O}from"./dot-04a474de.js";import"./Data-0e2d5449.js";import"./ValtioElement-af4c0565.js";import"./converters-40be0569.js";import"./stack-9d0bf26d.js";function R(n,r=y){if(typeof n[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let t=Array.from(n);const e=new Float64Array(t.length);r.length!==2&&(t=t.map(r),r=y);const o=(i,l)=>r(t[i],t[l]);let s,a;return n=Uint32Array.from(t,(i,l)=>l),n.sort(r===y?(i,l)=>j(t[i],t[l]):H(o)),n.forEach((i,l)=>{const c=o(i,s===void 0?i:s);c>=0?((s===void 0||c>0)&&(s=i,a=l),e[i]=a):e[i]=NaN}),e}function A(n={},r={}){const t=Z(r),e=Object.entries(n).map(([o,s])=>{const a=G(o,r);if(a==null)throw new Error(`missing channel: ${o}`);const[i,l]=J(a);return{key:o,input:a,output:i,setOutput:l,map:ht(s)}});return{...K(r,(o,s)=>{const a=E(o,t),i=e.map(({input:c})=>E(o,c)),l=e.map(({setOutput:c})=>c(new Array(o.length)));for(const c of s)for(const u of a?Q(c,d=>a[d]).values():[c])e.forEach(({map:d},M)=>d.mapIndex(u,i[M],l[M]));return{data:o,facets:s}}),...Object.fromEntries(e.map(({key:o,output:s})=>[o,s]))}}function ht(n){if(n==null)throw new Error("missing map");if(typeof n.mapIndex=="function")return n;if(typeof n.map=="function"&&U(n))return xt(n);if(typeof n=="function")return g(V(n));switch(`${n}`.toLowerCase()){case"cumsum":return yt;case"rank":return g((r,t)=>R(r,e=>t[e]));case"quantile":return g((r,t)=>dt(r,e=>t[e]))}throw new Error(`invalid map: ${n}`)}function xt(n){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:n.map.bind(n)}}function dt(n,r){const t=pt(n,r)-1;return R(n,r).map(e=>e/t)}function g(n){return{mapIndex(r,t,e){const o=n(r,t);if(o.length!==r.length)throw new Error("map function returned a mismatched length");for(let s=0,a=r.length;s<a;++s)e[r[s]]=o[s]}}}const yt={mapIndex(n,r,t){let e=0;for(const o of n)t[o]=e+=r[o]}},gt={ariaLabel:"tick",fill:null,stroke:"currentColor"};class P extends W{constructor(r,t,e){super(r,t,e,gt),v(this,e)}render(r,t,e,o,s){return tt("svg:g",s).call(rt,this,o,s).call(this._transform,this,t).call(a=>a.selectAll().data(r).enter().append("line").call(nt,this).attr("x1",this._x1(t,e,o)).attr("x2",this._x2(t,e,o)).attr("y1",this._y1(t,e,o)).attr("y2",this._y2(t,e,o)).call(et,this,e).call(ot,this,e,s)).node()}}class bt extends P{constructor(r,t={}){const{x:e,y:o,inset:s=0,insetTop:a=s,insetBottom:i=s}=t;super(r,{x:{value:e,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},t),this.insetTop=f(a),this.insetBottom=f(i)}_transform(r,t,{x:e}){r.call(I,t,{x:e},L,0)}_x1(r,{x:t}){return e=>t[e]}_x2(r,{x:t}){return e=>t[e]}_y1({y:r},{y:t},{marginTop:e}){const{insetTop:o}=this;return t&&r?s=>t[s]+o:e+o}_y2({y:r},{y:t},{height:e,marginBottom:o}){const{insetBottom:s}=this;return t&&r?a=>t[a]+r.bandwidth()-s:e-o-s}}class wt extends P{constructor(r,t={}){const{x:e,y:o,inset:s=0,insetRight:a=s,insetLeft:i=s}=t;super(r,{y:{value:o,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},t),this.insetRight=f(a),this.insetLeft=f(i)}_transform(r,t,{y:e}){r.call(I,t,{y:e},0,L)}_x1({x:r},{x:t},{marginLeft:e}){const{insetLeft:o}=this;return t&&r?s=>t[s]+o:e+o}_x2({x:r},{x:t},{width:e,marginRight:o}){const{insetRight:s}=this;return t&&r?a=>t[a]+r.bandwidth()-s:e-o-s}_y1(r,{y:t}){return e=>t[e]}_y2(r,{y:t}){return e=>t[e]}}function _t(n,{x:r=h,...t}={}){return new bt(n,{...t,x:r})}function Mt(n,{y:r=h,...t}={}){return new wt(n,{...t,y:r})}function Et(n,{x:r=h,y:t=null,fill:e="#ccc",fillOpacity:o,stroke:s="currentColor",strokeOpacity:a,strokeWidth:i=2,sort:l,...c}={}){const u=t!=null?lt:q;return T(st(n,u({x1:w,x2:_},{x:r,y:t,stroke:s,strokeOpacity:a,...c})),mt(n,u({x1:"p25",x2:"p75"},{x:r,y:t,fill:e,fillOpacity:o,...c})),_t(n,u({x:"p50"},{x:r,y:t,stroke:s,strokeOpacity:a,strokeWidth:i,sort:l,...c})),O(n,A({x:X},{x:r,y:t,z:t,stroke:s,strokeOpacity:a,...c})))}function B(n,{y:r=h,x:t=null,fill:e="#ccc",fillOpacity:o,stroke:s="currentColor",strokeOpacity:a,strokeWidth:i=2,sort:l,...c}={}){const u=t!=null?ut:q;return T(at(n,u({y1:w,y2:_},{x:t,y:r,stroke:s,strokeOpacity:a,...c})),ft(n,u({y1:"p25",y2:"p75"},{x:t,y:r,fill:e,fillOpacity:o,...c})),Mt(n,u({y:"p50"},{x:t,y:r,stroke:s,strokeOpacity:a,strokeWidth:i,sort:l,...c})),O(n,A({y:X},{x:t,y:r,z:t,stroke:s,strokeOpacity:a,...c})))}function X(n){const r=w(n),t=_(n);return n.map(e=>e<r||e>t?e:NaN)}function w(n){const r=D(n)*2.5-z(n)*1.5;return it(n,t=>t>=r?t:NaN)}function _(n){const r=z(n)*2.5-D(n)*1.5;return ct(n,t=>t<=r?t:NaN)}function D(n){return k(n,.25)}function z(n){return k(n,.75)}var Bt=Object.defineProperty,Nt=Object.getOwnPropertyDescriptor,x=(n,r,t,e)=>{for(var o=e>1?void 0:e?Nt(r,t):r,s=n.length-1,a;s>=0;s--)(a=n[s])&&(o=(e?a(r,t,o):a(o))||o);return e&&o&&Bt(r,t,o),o};let p=class extends ${constructor(){super(...arguments),this.mark="box",this.direction="vertical",this.markOptions=["x","y","direction"]}get plot(){const n=this==null?void 0:this.currentResults,r=this.allOptions;return(t,e)=>{const o=n!=null&&n.length?n:t;switch(this.direction){case"horizontal":return Et(o,{...e,...r});case"vertical":return B(o,{...e,...r});default:return B(o,{...e,...r})}}}render(){return null}};x([b({type:String})],p.prototype,"x",2);x([b({type:String})],p.prototype,"y",2);x([b({type:String})],p.prototype,"direction",2);p=x([Y("osl-box")],p);const Xt={title:"Marks"},m=()=>F`
    <osl-plot
      width = 1000
      height = 500
      marginLeft = 60
      marginBottom = 100
      data="http://localhost:6006/data/household.json"
    >
      <osl-axis tickRotate="90"></osl-axis>
      <osl-box x="State" y="MedianHouseholdIncome"></osl-box>
    </osl-plot>
    `;var N,S,C;m.parameters={...m.parameters,docs:{...(N=m.parameters)==null?void 0:N.docs,source:{originalSource:`() => {
  return html\`
    <osl-plot
      width = 1000
      height = 500
      marginLeft = 60
      marginBottom = 100
      data="http://localhost:6006/data/household.json"
    >
      <osl-axis tickRotate="90"></osl-axis>
      <osl-box x="State" y="MedianHouseholdIncome"></osl-box>
    </osl-plot>
    \`;
}`,...(C=(S=m.parameters)==null?void 0:S.docs)==null?void 0:C.source}}};const Dt=["Box"];export{m as Box,Dt as __namedExportsOrder,Xt as default};
//# sourceMappingURL=Box.stories-c2730e68.js.map
